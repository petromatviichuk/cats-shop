before_install:
  - pip install --user awscli
  - export PATH=$PATH:$HOME/.local/bin
  - chmod +x ./scripts/auth.sh && ./scripts/auth.sh

env:
  global:
  - secure: PoEY7/27Aweq3u42h6+5BFA6F3kI/BBomu9/51oDLqL9SSJOv7zDHkQpdpAwkvhbF+bFCCVjBUZFUfwh7f4zv7P4Nc4rl7gHg8jUYjorz3tVZcOzBmSMhszaqI4NNXlELyH+6RLHXUFgH/bG6hzv+IIhaA8QE9eM5zOe6nlAycYqi0YYuKigg9vqOB0+2wQDD7l4N4NS2D+fWE5r2SS6GNpy+YHiU3tKDwqdJghqWEDt+ZHOtm9GdQ8aV53w0ZEfMaqddwGJvVLC39ELTc0xiDx933YMWp8NvYTX0gNLox5Oi9p7VJ0DkLCHFPsYDYwglyJtyaY32E1EobdUGmFMFp9Tbx8jfi9ekn18fHFkVssmghznkw1zSxUnWdTUokuRraQ1MKGIfvaNgTngXRp/wtU5/D546QD3LZua5bhPp5d3a7uqjEJctBzA+3nW5crJXDdmvJodDAYFsbbrZdjSMBmLnBhRf2j4n6riHudIYQPbyIB8W4uX9tRhev3SWUjfHyeHe1489XpprET/Qtn5KDpLoQDwYXSptNEUWmajFpNoelSCDENzQFiim5NT+EifWGR0UXN4ajkeOXn9WHIeOYIhr5KsWBaRW+d8RMM0t6yJlUtrYPjytzhtt5AolyntLYfjXkm1OSwP1+7uy6x50GQSCxD7djTwJJ9HkB3sEws=
  - secure: MsceLWnHdwSD4JYJR9wNIc2YwBYCE5lul8GN1xqA5TKRInDAueBZKJVTUQwLRFfjoEs1V7Z4XtVgVUc79pk36s2OtE7E7SCZNlDW3RHSDif6fxzp3JpjwMX33m0m8MvikVY2TQ/mtdPL/yelUVwGAoKAt9bRtG+tzsXn0PVichUgjhc4/SzNxMItrXp66Oj8kPLvUEWHpjvEEjIwE5Q/dUXrRZhXgu2DN9fwNzV1NL7lx1obd4uK8RKnDTg6rMs79IIWMAZUU4fK+eLJlE7Jisb6l2JawBIJuuX1ycMHetMnSJiJFkQ1ID1MnZv2EV23np0KdzPLoP3uPSY6p5mcV5G3J9nz2jSs3hEEXIMHGQ0OfIlS6gYTKWsv8Fxd1alV+RSbNKccxwMupnTzQPRACv999nDKqjDtM4nJksg58vE2gUDHUYViXPP8JRAiGlIY/ZH+PhP5Q+cERtxsR+DOYcXTE3Le7BgZyPukAG9g9DDWutlAvhcq03zqxwSnOriIWYSLVpeRy1hxchIo8Z9mkk+XX8vza6EvdABv+I1fv3SPIJcC0YXCfK8kvsWBM8ufzNNo9uU3olS/DLE4fsdSndlMv5msiUkevJ8J+FHQkQ+xxavzKoL1wJikAx/xcnjNH7OYi2xA5tstKr+v4kOeAg67jzw/Zlm50eB4RSVtRGQ=

language: ruby
rvm:
- 2.3.1
addons:
  postgresql: 9.6
before_script:
- psql -c 'create database cats_shop_test;' -U postgres
dist: trusty
script:
- bundle install
- bundle exec rake db:create
- bundle exec rake db:migrate
- bundle exec rake db:seed
- bundle exec rake db:test:prepare
- bundle exec rspec

deploy:
  - provider: script
    script: bash scripts/deploy.sh $TRAVIS_PULL_REQUEST_SHA 
