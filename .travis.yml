before_install:
  - pip install --user awscli
  - export PATH=$PATH:$HOME/.local/bin

language: ruby
rvm:
- 2.3.1
addons:
  postgresql: 9.6
before_script:
- psql -c 'create database cats_shop_test;' -U postgres
dist: trusty
script:
- bundle install
- bundle exec rake db:create
- bundle exec rake db:migrate
- bundle exec rake db:seed
- bundle exec rake db:test:prepare
- bundle exec rspec

deploy:
  script: bash scripts/deploy.sh $TRAVIS_PULL_REQUEST_SHA
